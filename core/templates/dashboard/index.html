{% extends 'base.html'%}

{% load static %}

<!---modal content-->
{% block modal %}
 {% if usermaintask %}

    
    
    
 <div class="">
                  <!---Card content--> 
   <div class="row row-cols-3">                
 
 
    
    {% for usobj in usrobj %}
     
                            <div class="card bg-light mb-3 ml-2 mt-4" style="max-width: 18rem;">
     
     
                                  
                                  <div class="card-body bg-white">
                                          <img class="card-img-top img-circle rounded-circle mt-1" src="{{usobj.profile_image.url}}" alt="Card image cap">
                                      
                                    <h5 class="card-title text-center mt-3">{{usobj.first_name}} {{usobj.family_name}}</h5>
                                    <hr>
                                    <small class="text-muted"><span><i class="fas fa-envelope text-dark"></i></span> Email:</small>
                                    <h6>{{usobj.email}}</h6>
                                    <small class="text-muted p-t-30 db"><span><i class="fas fa-mobile-alt text-dark"></i></span> Mobile:</small>
                                    <h6>{{usobj.mobile_phone}}</h6>
                                    <small class="text-muted p-t-30 db"><span><i class="fas fa-blender-phone text-dark"></i></span> Ms Teams:</small>
                                    <h6><a href="{{usobj.teams_link}}">Teams Link</a></h6>
                                    <small class="text-muted p-t-30 db"><span><i class="fas fa-map-marker-alt text-dark"></i></span> Location:</small>
                                    <h6>{{usobj.user_location}}</h6>
                                  </div>
                                  <div class="card-footer">
                                      <div class="text-center">
                                          <i class="fas fa-layer-group fa-2x p-2 ic1" data-toggle="tooltip" data-placement="top" title="Assigned Tickets"> {{usobj.num_ts}}</i>
                                          <i class="fas fa-hourglass-half fa-2x p-2 ic2" data-toggle="tooltip" data-placement="top" title="Tasks Paused"> {{usobj.paused}}</i>
                                           
                                          <i class="fas fa-tasks fa-2x p-2 ic3" data-toggle="tooltip" data-placement="top" title="Tasks Completed"> {{usobj.complete}}</i>
                                          
                                      </div>
                                  </div>
                                  </div>
                                    
                                  {% endfor %}

                                </div>
                                
                           </div>     
                   <!---content here-->      
      {% endif %}
        <!---End of modal content-->  
{% endblock modal %}


{% block content %}
<link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
<!---card dashboard section-->
<div class="container-fluid">
<h4 class="page-title mt-5">Dashboard</h4>
<div class="row">

<!---Cards section--->
 <!-- Column -->
                    <div class="col-md-6 col-lg-2 col-xlg-3 mt-2 mb-4">
                        <div class="card card-hover">
                        <div class="card-header">
                              <h5 class="text-muted">Total Active Tasks</h5>
                            </div>
                            <div class="box bgcyan text-center">
                            
                                
                                <div class="text-center text-secondary">
                                  
                                  <h2 class="mr-1 mt-2 mb-2 text-white"><i class="fas fa-layer-group fa-1x text-light"></i> {{ active_tasks }}</h2>
                                </div>
                                
                            </div>
                        </div>
                    </div>

                 <!-- Column -->
                    <div class="col-md-6 col-lg-2 col-xlg-3 mt-2">
                        <div class="card card-hover">
                        <div class="card-header">
                              <h5 class="text-muted">Tasks Over Due</h5>
                            </div>
                            <div class="box bgdanger text-center">
                            
                               
                                <div class="text-center bgdanger">
                                  <h5 class="text-light"></h5>
                                  <h2 class="mr-1 mt-2 mb-2  text-white"><i class="fas fa-hourglass-half fa-1x text-light"></i> {{ due_task }}</h2>
                                </div>
                                
                            </div>
                        </div>
                        
                    </div>    
                    
                     <!-- Column -->
                    <div class="col-md-6 col-lg-2 col-xlg-3 mt-2">
                        <div class="card card-hover">
                        <div class="card-header">
                            <h5 class="text-muted">Tasks Puased  </h5>
                            </div>
                            <div class="box bgwarning text-center">
                               
                                <h2 class="mr-1 mb-2 mt-2 text-white"> <i class="far fa-pause-circle fa-1x text-light"></i> {{ task_paused }}</h2>
                            </div>
                        </div>
                    </div>
                    <!-- Column -->
                    <div class="col-md-6 col-lg-2 col-xlg-3 mt-2">
                        <div class="card card-hover">
                        <div class="card-header">
                            <h5 class="text-muted">Tasks Completed</h5>
                            </div>
                            <div class="box bgsuccess text-center">
                                
                                <h2 class="mr-1 mb-2 mt-2 text-white"><i class="fas fa-tasks fa-1x text-light"></i> {{ task_completed }}</h2>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Column -->
                    <div class="col-md-6 col-lg-2 col-xlg-3 mt-2">
                        <div class="card card-hover">
                               <div class="card-header">
                                <h5 class="text-muted">Tasks Not Started</h5>
                                </div>
                            <div class="box bginfo text-center">
                                
                                <h2 class="mr-1 mt-2 mb-2 text-white"><i class="fas fa-play-circle fa-1x text-light"></i> {{task_started}}</h2>
                            </div>
                        </div>
                    </div>
                    <!-- Column -->
                    
                    <!-- Column -->
<!-----End Of Card Section------>



  
</div>
  
</div>
<!-----Dashboard part 2-->

<!------Start recent tasks----->
<div class="row" id="dashsecond">
        <div class="col-lg-6"> 
       <div class="card">
         <div class="card-body">
             <h4 class="page-title card-title">Recent Tasks</h4>
         </div>
         <div class="comment-widgets ">
             <!-- Comment Row -->
             <!---Recent Tasks-->
      <div class="accordion" id="accordionDrop">
    <!--/*start django code*/ -->
    {% if recent_task %}
                        
    
    {% for rtasks in recent_task %}
    
        
         <div class="card m-b-0">
             <div class="card-header" id="heading-{{ rtasks.id }}">
               <h5 class="mb-0">
                 <a class="artasks" data-toggle="collapse" data-target="#collapse-{{ rtasks.id }}" aria-expanded="true" aria-controls="collapse-{{ rtasks.id }}">
                     <i class="m-r-5 fas fa-th-list" aria-hidden="true"></i>
                     <span>{{rtasks.task_title}}</span>
                 </a>
               </h5>
             </div>
             <div id="collapse-{{ rtasks.id }}" class="collapse" aria-labelledby="heading-{{ rtasks.id }}" data-parent="#accordionDrop">
               <div class="card-body">
              
                                 <span class="todo-desc">{{rtasks.task_title}}</span> <span class="badge badge-pill badge-danger float-right">{{ current_time|timeuntil:rtasks.created_at }}</span>
              
                     <ul class="list-inline">
                              <li class="assignee list-inline-item">Global Task Assign To:</li>
                             <li class="assignee list-inline-item"><img class="rounded-circle" width="40" src="{{ rtasks.global_task_assign.profile_image.url }}" alt="{{rtasks.global_task_assign.username}}" data-toggle="tooltip" data-placement="top" title="" data-original-title="{{rtasks.global_task_assign.first_name}} {{rtasks.global_task_assign.family_name}}"></li>
                      </ul>    
                       <ul class="list-inline">  
                          <li class="assignee list-inline-item">Sub Task Assign To:</li> 
                            {% for usr in rtasks.item_main.all %}
                              <li class="assignee list-inline-item"><img class="rounded-circle" width="40" src="{{usr.task_assign.profile_image.url }}" alt="{{usr.task_assign}}" data-toggle="tooltip" data-placement="top" title="" data-original-title="{{usr.task_assign.first_name}} {{usr.task_assign.family_name}}"></li>
                              
                             {% endfor %}
                            
                         </ul>
                          {{rtasks.global_task_info}}
                 <div class="d-flex no-block align-items-center m-t-25">
                         <span> <strong>{{rtasks.overall_precent_complete}}%</strong>  Global Progress</span>
                         <div class="ml-auto">
                             <span>100%</span>
                         </div>
                     </div>
                     <div class="progress">
                         <div class="progress-bar progress-bar-striped bg-info" role="progressbar" style="width: {{rtasks.overall_precent_complete}}%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"></div>
                     </div>
                <div class="comment-footer mt-3">
                         <span class="text-muted float-right">Due Date: {{ rtasks.due_date| date:"M d, Y" }}</span> 
                         <button type="button" class="btn btn-cyan btn-sm">View task</button>
                         <button type="button" class="btn btn-success btn-sm">Updtae Task</button>
                         <button type="button" class="btn btn-danger btn-sm">Delete Task</button>
                     </div>     
               </div>
             </div>
         </div>
        {% endfor %}    
          {% endif %} 
          
         </div>
     </div>
   
             <!---End OF Recent Tasks objects-->

             
             
             
         </div>
       
      <!-- Tasks updates news -->
      <div class="card">
        <div class="card-body">
            <h4 class="page-title ecard-title m-b-0">Tasks News Updates</h4>
        </div>
        <ul class="list-style-none">
            {% if recent_updates %}
            {% for newtsk in recent_updates  %}
            <li class="d-flex no-block card-body">
                <i class="fas fa-info-circle w-30px m-t-5"></i>
                <div>
                    <a href="#" class="m-b-0 font-medium p-0">{{newtsk.task_title}}</a>
                    <span class="text-muted">{{newtsk.global_task_info}}</span>
                </div>
                <div class="ml-auto">
                    <div class="tetx-right">
                        <h5 class="text-muted m-b-0">{{newtsk.updated_at|date:"d"}}</h5>
                        <span class="text-muted font-16">{{newtsk.updated_at|date:"M" }}</span>
                    </div>
                </div>
            </li>
            {% endfor %}
           {% endif %}
        </ul>
    </div>

<!-- End Tasks updates news -->   
         



     </div>

   
  
    <!---End OF Recent Tasks DIV-->
 
 <!---Over Due Task-->
    <div class="col-lg-6">
        <!-- Card -->
        <div class="card">
            <div class="card-body">
                <h4 class="page-title card-title">Upcoming Over Due Tasks</h4>
                <div class="chat-box scrollable" style="height:520px;">
              <!--CALANDER Row -->
    <div class="row"> 
        <!----over due card--> 
        {% if due_task_obj %}
        
       {% for due in due_task_obj  %}
       
       
              
                <div class="container calcontainer">
                     <div class="row row-striped">
                        <div class="col-2 text-right">
                     <h1 class="display-4"><span class="badge badge-secondary"> {{due.due_date|date:"d" }}</span></h1>
                          <h2 class="capi">{{due.due_date|date:"M" }}</h2>
            </div>
            <div class="col-10">
            <h3 class="text-uppercase"><strong>{{ due.task_title }}</strong></h3>
            <ul class="list-inline">
            <li class="list-inline-item"><i class="fa fa-calendar-o" aria-hidden="true"></i> {{due.due_date | date:" l " }}</li>
            <li class="list-inline-item"><i class="fa fa-clock-o" aria-hidden="true"></i> {{due.due_date}}</li>
            <li class="list-inline-item"><i class="fa fa-location-arrow" aria-hidden="true"></i> {{due.task_location}}</li>
            </ul>
            <p>{{due.global_task_info}}</p>
            </div>
            <div class="overlay">
            <div class="text">{{due.task_title}}
            <hr class="hline"> 
            <p class="text-light">{{due.global_task_info|slice:":50"}}</p>
            <button type="button" class="btn btn-primary mb-2">View Details</button>
            </div>
            </div>
            </div>
            </div>
            {% endfor %}  
        {% endif %}
        <!----End of over due card-->    
            
    
    </div>
              <!--END CALANDER Row -->      
        <!-- card -->
       
        </div>
        
        
    </div>
    </div>
    
    </div>
    
       <!----End Of Over Due Tasks --> 
    



   </div>
   <!---End of recent taasks row-->

    
   
   </div>
   

 
{% endblock content %}